import{f as g}from"./fetch-twLTWqyN.js";S();document.addEventListener("DOMContentLoaded",function(){E()});async function E(){console.log("Haetaan kaikki käyttäjän harjoitukset tietokannasta");const i=`http://127.0.0.1:3000/api/exercises/${localStorage.getItem("user_id")}`,s={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};g(i,s).then(a=>{console.log("Tässä data:",a),k(a)})}function k(e){const i=document.querySelector(".tbody");i.innerHTML="";const n=document.getElementById("editExerciseModal");e.reverse().forEach(t=>{const o=document.createElement("tr"),d=new Date(t.date).toLocaleDateString("fi-Fi"),c=document.createElement("td");c.innerText=d;const r=document.createElement("td");r.innerText=t.type;const l=document.createElement("td");t.intensity==="High"?l.innerText="Kova":t.intensity==="Medium"?l.innerText="Keskiverto":t.intensity==="Low"&&(l.innerText="Matala");const u=document.createElement("td"),p=Math.floor(t.duration/60),h=t.duration%60;p>0?u.innerText=`${p} t ${h} min`:u.innerText=`${h} min`;const v=document.createElement("td"),m=document.createElement("button");m.className="del",m.setAttribute("data-id",t.exercise_id),m.innerText="Poista merkintä",m.addEventListener("click",x),v.appendChild(m);const I=document.createElement("td"),y=document.createElement("button");y.className="mod",y.setAttribute("data-id",t.exercise_id),y.innerText="Muokkaa",y.addEventListener("click",()=>B(t)),I.appendChild(y),o.appendChild(c),o.appendChild(r),o.appendChild(l),o.appendChild(u),o.appendChild(I),o.appendChild(v),i.appendChild(o)}),document.querySelector(".close").addEventListener("click",()=>{n.style.display="none"}),window.onclick=function(t){t.target==n&&(n.style.display="none")}}function B(e){document.getElementById("editDate").value=new Date(e.date).toISOString().split("T")[0],document.getElementById("editActivity").value=e.type,document.getElementById("editIntensity").value=e.intensity;const i=Math.floor(e.duration/60).toString().padStart(2,"0"),n=(e.duration%60).toString().padStart(2,"0");document.getElementById("editDuration").value=`${i}:${n}`,document.getElementById("exerciseId").value=e.exercise_id,document.getElementById("editExerciseForm").addEventListener("submit",D);const a=document.getElementById("editExerciseModal");a.style.display="block"}document.getElementById("exerciseForm").addEventListener("submit",f);function f(e){e.preventDefault(),console.log(e);const i="http://127.0.0.1:3000/api/exercises/";let n=localStorage.getItem("token");const s=document.getElementById("setDuration").value,[a,t]=s.split(":").map(Number),o=a*60+t,d={type:document.getElementById("setActivity").value,duration:o,intensity:document.getElementById("setIntensity").value,date:document.getElementById("setDate").value};console.log(d);const c={method:"POST",headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"},body:JSON.stringify(d)};g(i,c).then(r=>{console.log(r),alert("Harjoitus lisätty onnistuneesti!"),document.getElementById("setActivity").value="",document.getElementById("setIntensity").value="",document.getElementById("setDuration").value="",document.getElementById("setDate").value="",E()})}function x(e){const n=`http://127.0.0.1:3000/api/exercises/${e.target.attributes["data-id"].value}`,a={method:"DELETE",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};confirm("Haluatko varmasti poistaa harjoituksen?")&&(console.log("Poisto onnistunut"),g(n,a).then(o=>{console.log(o),E()}))}function D(e){e.preventDefault(),console.log("Päivitetään harjoitus");const i=localStorage.getItem("username"),s=`http://127.0.0.1:3000/api/exercises/${document.getElementById("exerciseId").value}`;let a=localStorage.getItem("token");const t=document.getElementById("editDuration").value,[o,d]=t.split(":").map(Number),c=o*60+d,r={user_id:i,type:document.getElementById("editActivity").value,duration:c,intensity:document.getElementById("editIntensity").value,date:document.getElementById("editDate").value},l={method:"PUT",headers:{Authorization:"Bearer: "+a,"Content-Type":"application/json"},body:JSON.stringify(r)};g(s,l).then(u=>{console.log(u),alert("Harjoituksen päivitys onnistui!");const p=document.getElementById("editExerciseModal");p.style.display="none",E()})}function S(){console.log("Hei, täällä ollaan!");const e="http://127.0.0.1:3000/api/auth/me",n={method:"GET",headers:{Authorization:"Bearer: "+localStorage.getItem("token")}};g(e,n).then(s=>{document.getElementById("name").innerHTML=s.user.username})}document.getElementById("logout").addEventListener("click",function(){confirm("Haluatko varmasti kirjautua ulos?")&&(alert("Kirjauduttu ulos onnistuneesti! "),localStorage.removeItem("token"),localStorage.removeItem("username"),window.location.href="index.html")});
