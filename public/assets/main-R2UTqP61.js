import{f as i}from"./fetch--FzvIhyn.js";const u=document.getElementById("create_user"),t=document.getElementById("createUserModal"),d=t.querySelector(".close");u.addEventListener("click",()=>{t.style.display="block"});d.addEventListener("click",()=>{t.style.display="none"});window.addEventListener("click",e=>{e.target==t&&(t.style.display="none")});const y=t.querySelector(".createuser"),c=t.querySelector("#create_user_form");y.addEventListener("click",async e=>{e.preventDefault();const o="http://127.0.0.1:3000/api/users",r={username:c.querySelector("input[name=username]").value,password:c.querySelector("input[name=password]").value,email:c.querySelector("input[name=email]").value},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};try{const s=await i(o,a);console.log(s),alert("Uusi käyttäjä luotu onnistuneesti! Voit nyt kirjautua sisään."),t.style.display="none"}catch(s){console.error(s),alert("Virhe käyttäjää luodessa. Tarkista tiedot ja yritä uudelleen.")}});const m=document.querySelector(".loginuser");m.addEventListener("click",async e=>{e.preventDefault(),console.log("Nyt logataan sisään");const o="http://127.0.0.1:3000/api/auth/login",r=document.querySelector("#login_form"),a={username:r.querySelector("input[name=username]").value,password:r.querySelector("input[name=password]").value},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};i(o,s).then(n=>{console.log(n),console.log(n.token),localStorage.setItem("token",n.token),n.token==null?alert("Unauthorized user: käyttäjänimi tai salasana ei täsmää"):(alert("Olet nyt kirjautunut"),localStorage.setItem("username",n.user.username),localStorage.setItem("user_id",n.user.user_id),window.location.href="home.html"),k("loginResponse",`localStorage set with token value: ${n.token}`)})});const l=document.getElementById("loginModal"),p=document.getElementById("login"),g=l.querySelector(".close");p.onclick=function(){l.style.display="block"};g.onclick=function(){l.style.display="none"};window.onclick=function(e){e.target==l&&(l.style.display="none")};function k(e,o){document.getElementById(e).innerText=o}
